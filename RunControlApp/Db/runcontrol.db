record(ao, "$(PV):RC:HIGH")
{
    field(DESC, "Run control high limit")
	field(PREC, "2")
    info(autosaveFields, "VAL")
}

record(ao, "$(PV):RC:LOW")
{
    field(DESC, "Run control low limit")
	field(PREC, "2")
    info(autosaveFields, "VAL")
}

record(bo, "$(PV):RC:ENABLE")
{
    field(DESC, "Run control enable")
	field(ZNAM, "NO")
	field(ONAM, "YES")
	field(VAL, 0)
	field(FLNK, "$(PV):RC:_CALC")
    info(autosaveFields, "VAL")
}

record(bi, "$(PV):RC:INRANGE")
{
    field(DESC, "Run control in range")
	field(ZNAM, "NO")
	field(ONAM, "YES")
	field(VAL, 1)
}

## only scan if run control enabled
record(bo, "$(PV):RC:_CALCSCAN")
{
    field(SCAN, "1 second")
	field(SDIS, "$(PV):RC:ENABLE")
	field(DISV, "0")
	field(FLNK, "$(PV):RC:_CALC")
}

## for a selection record: 56 means fire output 4 5 6; 7 means fire outputs 1 2 3
## for a selection record: 12 means fire output 3 4; 3 means fire outputs 1 2
record(calcout, "$(PV):RC:_CALC")
{
    field(INPA, "$(PV)")
    field(INPB, "$(PV):RC:LOW")
    field(INPC, "$(PV):RC:HIGH")
    field(INPD, "$(PV):RC:ENABLE")
	field(CALC, "((D=0)||(A>=B&&A<=C))?12:3")
	field(OOPT, "Every Time")
	field(DOPT, "Use CALC")
	field(OUT, "$(PV):RC:_SEQ.SELN")
	field(FLNK, "$(PV):RC:_SEQ.PROC")
}	

record(sseq, "$(PV):RC:_SEQ")
{
    field(SELM, "Mask")
	field(STR1, "NO")
	field(STR2, "$(PV)")
	field(STR3, "YES")
	field(STR4, "$(PV)")
	field(LNK1, "$(PV):RC:INRANGE PP")
	field(LNK2, "$(PV):RC:_OUT PP")
	field(LNK3, "$(PV):RC:INRANGE PP")
	field(LNK4, "$(PV):RC:_IN PP")
}

record(waveform, "$(PV):RC:_OUT")
{
	field(NELM, "256")
	field(FTVL, "CHAR")
	field(FLNK, "$(PV):RC:_OUT:DO.PROC")
}	

record(aSub, "$(PV):RC:_OUT:DO")
{
    field(SNAM, "addToSet")
	field(INPA, "$(P)CS:RC:_SETNAME")
	field(FTA, "STRING")
	field(INPB, "$(PV):RC:_OUT")
	field(FTB, "CHAR")
	field(NOB, "256")
	field(INPC, "$(PV):RC:_OUT.NELM") # NORD not set by CA
	field(FTC, "ULONG")
	field(FLNK, "$(P)CS:RC:_OUT:CNT.PROC")
}

record(waveform, "$(PV):RC:_IN")
{
	field(NELM, "256")
	field(FTVL, "CHAR")
	field(FLNK, "$(PV):RC:_IN:DO.PROC")
}	

record(aSub, "$(PV):RC:_IN:DO")
{
    field(SNAM, "removeFromSet")
	field(INPA, "$(P)CS:RC:_SETNAME")
	field(FTA, "STRING")
	field(INPB, "$(PV):RC:_IN")
	field(FTB, "CHAR")
	field(NOB, "256")
	field(INPC, "$(PV):RC:_IN.NELM") # NORD not set by CA
	field(FTC, "ULONG")
	field(FLNK, "$(P)CS:RC:_OUT:CNT.PROC")
}
