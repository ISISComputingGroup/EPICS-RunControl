record(ao, "$(PV):$(MODE):HIGH")
{
    field(DESC, "$(MODE) Control high limit")
	field(PREC, "2")
    info(autosaveFields, "VAL")
}

record(ao, "$(PV):$(MODE):LOW")
{
    field(DESC, "$(MODE) control low limit")
	field(PREC, "2")
    info(autosaveFields, "VAL")
}

record(bo, "$(PV):$(MODE):ENABLE")
{
    field(DESC, "$(MODE) control enable")
	field(ZNAM, "NO")
	field(ONAM, "YES")
	field(VAL, 0)
	field(FLNK, "$(PV):$(MODE):_CALC")
    info(autosaveFields, "VAL")
}

record(bi, "$(PV):$(MODE):INRANGE")
{
    field(DESC, "$(MODE) control in range")
	field(ZNAM, "NO")
	field(ONAM, "YES")
	field(VAL, 1)
}

## only scan if control enabled
record(bo, "$(PV):$(MODE):_CALCSCAN")
{
    field(SCAN, "1 second")
	field(SDIS, "$(PV):$(MODE):ENABLE")
	field(DISV, "0")
	field(FLNK, "$(PV):$(MODE):_CALC")
}

## for a selection record: 56 means fire output 4 5 6; 7 means fire outputs 1 2 3
## for a selection record: 12 means fire output 3 4; 3 means fire outputs 1 2
record(calcout, "$(PV):$(MODE):_CALC")
{
    field(INPA, "$(PV)")
    field(INPB, "$(PV):$(MODE):LOW")
    field(INPC, "$(PV):$(MODE):HIGH")
    field(INPD, "$(PV):$(MODE):ENABLE")
	field(CALC, "((D=0)||(A>=B&&A<=C))?12:3")
	field(OOPT, "Every Time")
	field(DOPT, "Use CALC")
	field(OUT, "$(PV):$(MODE):_SEQ.SELN")
	field(FLNK, "$(PV):$(MODE):_SEQ.PROC")
}	

record(sseq, "$(PV):$(MODE):_SEQ")
{
    field(SELM, "Mask")
	field(STR1, "NO")
	field(STR2, "$(PV)")
	field(STR3, "YES")
	field(STR4, "$(PV)")
	field(LNK1, "$(PV):$(MODE):INRANGE PP")
	field(LNK2, "$(PV):$(MODE):_OUT PP")
	field(LNK3, "$(PV):$(MODE):INRANGE PP")
	field(LNK4, "$(PV):$(MODE):_IN PP")
}

record(waveform, "$(PV):$(MODE):_OUT")
{
	field(NELM, "256")
	field(FTVL, "CHAR")
	field(FLNK, "$(PV):$(MODE):_OUT:DO.PROC")
}	

record(aSub, "$(PV):$(MODE):_OUT:DO")
{
    field(SNAM, "addToSet")
	field(INPA, "$(P)CS:$(MODE):_SETNAME")
	field(FTA, "STRING")
	field(INPB, "$(PV):$(MODE):_OUT")
	field(FTB, "CHAR")
	field(NOB, "256")
	field(INPC, "$(PV):$(MODE):_OUT.NELM") # NORD not set by CA
	field(FTC, "ULONG")
}

record(waveform, "$(PV):$(MODE):_IN")
{
	field(NELM, "256")
	field(FTVL, "CHAR")
	field(FLNK, "$(PV):$(MODE):_IN:DO.PROC")
}	

record(aSub, "$(PV):$(MODE):_IN:DO")
{
    field(SNAM, "removeFromSet")
	field(INPA, "$(P)CS:$(MODE):_SETNAME")
	field(FTA, "STRING")
	field(INPB, "$(PV):$(MODE):_IN")
	field(FTB, "CHAR")
	field(NOB, "256")
	field(INPC, "$(PV):$(MODE):_IN.NELM") # NORD not set by CA
	field(FTC, "ULONG")
}
